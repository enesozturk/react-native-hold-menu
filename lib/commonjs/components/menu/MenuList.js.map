{"version":3,"sources":["MenuList.tsx"],"names":["MenuListComponent","state","theme","menuProps","disableBlur","AnimatedView","value","Animated","createAnimatedComponent","BlurView","View","itemList","setItemList","React","useState","menuHeight","itemsWithSeparator","items","filter","item","withSeparator","length","prevList","messageStyles","translate","anchorPosition","itemWidth","_leftPosition","menuScaleAnimation","CONTEXT_MENU_STATE","ACTIVE","SPRING_CONFIGURATION_MENU","duration","HOLD_ITEM_TRANSFORM_DURATION","opacityAnimation","left","height","opacity","transform","translateX","beginningTransformations","translateY","scale","endingTransformations","animatedInnerContainerStyle","backgroundColor","IS_IOS","animatedProps","tint","setter","_items","styles","menuContainer","StyleSheet","absoluteFillObject","menuInnerContainer","MenuList","memo"],"mappings":"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","sourcesContent":["import React, { useMemo } from 'react';\nimport { StyleSheet } from 'react-native';\n\nimport Animated, {\n  runOnJS,\n  useAnimatedProps,\n  useAnimatedReaction,\n  useAnimatedStyle,\n  useDerivedValue,\n  useSharedValue,\n  withSpring,\n  withTiming,\n} from 'react-native-reanimated';\n\nimport {\n  calculateMenuHeight,\n  menuAnimationAnchor,\n} from '../../utils/calculations';\nimport { BlurView } from 'expo-blur';\n\nimport MenuItems from './MenuItems';\n\nimport {\n  SPRING_CONFIGURATION_MENU,\n  HOLD_ITEM_TRANSFORM_DURATION,\n  IS_IOS,\n  CONTEXT_MENU_STATE,\n} from '../../constants';\n\nimport styles from './styles';\nimport { MenuItemProps } from './types';\nimport { useInternal } from '../../hooks';\nimport { deepEqual } from '../../utils/validations';\nimport { leftOrRight } from './calculations';\n\n// const AnimatedView = Animated.createAnimatedComponent(View);\n\nconst MenuListComponent = () => {\n  const { state, theme, menuProps, disableBlur } = useInternal();\n\n  const AnimatedView = useMemo(\n    () =>\n      disableBlur?.value === false\n        ? Animated.createAnimatedComponent(BlurView)\n        : Animated.View,\n    [disableBlur]\n  );\n\n  const [itemList, setItemList] = React.useState<MenuItemProps[]>([]);\n\n  const menuHeight = useDerivedValue(() => {\n    const itemsWithSeparator = menuProps.value.items.filter(\n      item => item.withSeparator\n    );\n    return calculateMenuHeight(\n      menuProps.value.items.length,\n      itemsWithSeparator.length\n    );\n  }, [menuProps]);\n  const prevList = useSharedValue<MenuItemProps[]>([]);\n\n  const messageStyles = useAnimatedStyle(() => {\n    const itemsWithSeparator = menuProps.value.items.filter(\n      item => item.withSeparator\n    );\n\n    const translate = menuAnimationAnchor(\n      menuProps.value.anchorPosition,\n      menuProps.value.itemWidth,\n      menuProps.value.items.length,\n      itemsWithSeparator.length\n    );\n\n    const _leftPosition = leftOrRight(menuProps);\n\n    const menuScaleAnimation = () =>\n      state.value === CONTEXT_MENU_STATE.ACTIVE\n        ? withSpring(1, SPRING_CONFIGURATION_MENU)\n        : withTiming(0, {\n            duration: HOLD_ITEM_TRANSFORM_DURATION,\n          });\n\n    const opacityAnimation = () =>\n      withTiming(state.value === CONTEXT_MENU_STATE.ACTIVE ? 1 : 0, {\n        duration: HOLD_ITEM_TRANSFORM_DURATION,\n      });\n\n    return {\n      left: _leftPosition,\n      height: menuHeight.value,\n      opacity: opacityAnimation(),\n      transform: [\n        { translateX: translate.beginningTransformations.translateX },\n        { translateY: translate.beginningTransformations.translateY },\n        {\n          scale: menuScaleAnimation(),\n        },\n        { translateX: translate.endingTransformations.translateX },\n        { translateY: translate.endingTransformations.translateY },\n      ],\n    };\n  });\n\n  const animatedInnerContainerStyle = useAnimatedStyle(() => {\n    return {\n      backgroundColor:\n        theme.value === 'light'\n          ? disableBlur\n            ? 'rgba(255, 255, 255, 1)'\n            : IS_IOS\n            ? 'rgba(255, 255, 255, .75)'\n            : 'rgba(255, 255, 255, .95)'\n          : disableBlur\n          ? 'rgba(255, 255, 255, 1)'\n          : IS_IOS\n          ? 'rgba(0,0,0,0.5)'\n          : 'rgba(39, 39, 39, .8)',\n    };\n  }, [theme]);\n\n  const animatedProps = useAnimatedProps(() => {\n    return { tint: theme.value };\n  }, [theme]);\n\n  const setter = (items: MenuItemProps[]) => {\n    setItemList(items);\n    prevList.value = items;\n  };\n\n  useAnimatedReaction(\n    () => menuProps.value.items,\n    _items => {\n      if (!deepEqual(_items, prevList.value)) {\n        runOnJS(setter)(_items);\n      }\n    },\n    [menuProps]\n  );\n\n  return (\n    <AnimatedView\n      intensity={100}\n      animatedProps={animatedProps}\n      style={[styles.menuContainer, messageStyles]}\n    >\n      <Animated.View\n        style={[\n          StyleSheet.absoluteFillObject,\n          styles.menuInnerContainer,\n          animatedInnerContainerStyle,\n        ]}\n      >\n        <MenuItems items={itemList} />\n      </Animated.View>\n    </AnimatedView>\n  );\n};\n\nconst MenuList = React.memo(MenuListComponent);\n\nexport default MenuList;\n"]}